<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#2563eb">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icons/icon-192x192.png">
  <title>GeoWeb Kaffrine</title>

  <link rel="stylesheet" href="css/leaflet.css">
  <link rel="stylesheet" href="css/leaflet-measure.css">

  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/navbar.css">
  <link rel="stylesheet" href="css/mobile.css">
  <link rel="stylesheet" href="css/theme.css">
</head>
<body>
  <div id="app">
    <div class="ambient-bg" aria-hidden="true"></div>

    <header class="navbar" role="banner">
      <div class="brand" id="brandHome" role="button" tabindex="0" aria-label="Retour accueil">
        <span class="brand-logo" aria-hidden="true">GK</span>
        <div class="brand-copy">
          <span class="brand-text">GeoWeb Kaffrine</span>
          <span class="brand-subtext">Spatial Command Center</span>
        </div>
      </div>

      <nav class="desktop-nav" aria-label="Navigation principale">
        <ul class="nav-menu">
          <li class="nav-item dropdown">
            <button class="nav-btn dropdown-toggle" type="button" aria-expanded="false">ğŸ§­ Navigation</button>
            <div class="dropdown-menu" role="menu">
              <button type="button" class="menu-action" data-action="home">ğŸ  Accueil</button>
              <button type="button" class="menu-action" data-action="dashboard">ğŸ–¥ï¸ Command center</button>
              <button type="button" class="menu-action" data-action="metadata">â„¹ï¸ Metadonnees</button>
            </div>
          </li>
          <li class="nav-item dropdown">
            <button class="nav-btn dropdown-toggle" type="button" aria-expanded="false">ğŸ—‚ï¸ Donnees</button>
            <div class="dropdown-menu" role="menu">
              <button type="button" class="menu-action" data-action="layers">ğŸ§± Couches</button>
              <button type="button" class="menu-action" data-action="legend">ğŸ—ºï¸ Legende</button>
              <button type="button" class="menu-action" data-action="download">â¬‡ï¸ Telecharger</button>
            </div>
          </li>
          <li class="nav-item dropdown">
            <button class="nav-btn dropdown-toggle" type="button" aria-expanded="false">ğŸ“Š Analyse</button>
            <div class="dropdown-menu" role="menu">
              <button type="button" class="menu-action" data-action="analysis">ğŸ›°ï¸ Analyse spatiale</button>
              <button type="button" class="menu-action" data-action="analysis-modal">ğŸ¯ Analyse avancee</button>
              <button type="button" class="menu-action" data-action="routing">ğŸ›£ï¸ Itineraire</button>
              <button type="button" class="menu-action" data-action="measure">ğŸ“ Mesure</button>
            </div>
          </li>
          <li class="nav-item dropdown">
            <button class="nav-btn dropdown-toggle" type="button" aria-expanded="false">ğŸ‘ï¸ Affichage</button>
            <div class="dropdown-menu" role="menu">
              <button type="button" class="menu-action" data-action="basemap-osm">ğŸŒ Fond OSM</button>
              <button type="button" class="menu-action" data-action="basemap-toner">ğŸ§ª Fond Contraste</button>
              <button type="button" class="menu-action" data-action="zoom-in">â• Zoom +</button>
              <button type="button" class="menu-action" data-action="zoom-out">â– Zoom -</button>
              <button type="button" class="menu-action" data-action="full-extent">ğŸ”„ Actualiser page</button>
            </div>
          </li>
        </ul>
      </nav>

      <button id="mobileMenuToggle" class="icon-btn menu-toggle" type="button" aria-label="Ouvrir menu mobile" aria-expanded="false">&#9776;</button>
      <button id="themeToggle" class="icon-btn" type="button" aria-label="Basculer theme">Theme</button>
    </header>

    <aside id="mobileMenu" class="mobile-menu" aria-label="Menu mobile">
      <button type="button" class="menu-action" data-action="home">ğŸ  Accueil</button>
      <button type="button" class="menu-action" data-action="dashboard">ğŸ–¥ï¸ Command center</button>
      <button type="button" class="menu-action" data-action="layers">ğŸ§± Couches</button>
      <button type="button" class="menu-action" data-action="legend">ğŸ—ºï¸ Legende</button>
      <button type="button" class="menu-action" data-action="analysis">ğŸ›°ï¸ Analyse</button>
      <button type="button" class="menu-action" data-action="analysis-modal">ğŸ¯ Analyse avancee</button>
      <button type="button" class="menu-action" data-action="routing">ğŸ›£ï¸ Itineraire</button>
      <button type="button" class="menu-action" data-action="measure">ğŸ“ Mesure</button>
      <button type="button" class="menu-action" data-action="download">â¬‡ï¸ Telecharger</button>
      <button type="button" class="menu-action" data-action="install">ğŸ“² Installer</button>
      <button type="button" class="menu-action" data-action="metadata">â„¹ï¸ Metadonnees</button>
    </aside>

    <main class="map-shell">
      <div id="map" aria-label="Carte interactive"></div>
    </main>

    <section id="dashboardPanel" class="dashboard" aria-label="Tableau de bord">
      <div class="dashboard-head">
        <h2>Command center</h2>
        <button type="button" class="icon-btn panel-close" data-close-panel="dashboardPanel" aria-label="Fermer command center">x</button>
      </div>
      <div class="dashboard-grid">
        <article class="kpi-card">
          <h3>Features actives</h3>
          <p id="kpiFeatures">0</p>
        </article>
        <article class="kpi-card">
          <h3>Couches actives</h3>
          <p id="kpiLayers">0</p>
        </article>
        <article class="kpi-card">
          <h3>Zoom</h3>
          <p id="kpiZoom">-</p>
        </article>
        <article class="kpi-card">
          <h3>Theme</h3>
          <p id="kpiTheme">Clair</p>
        </article>
      </div>
      <div class="activity-feed">
        <h3>Activite recente</h3>
        <ul id="activityList"></ul>
      </div>
    </section>

    <div class="bottom-bar">
      <span id="statusText">Pret</span>
      <span id="scaleText">Echelle: -</span>
      <span id="networkText">Online</span>
    </div>

    <div class="data-quick-bar" aria-label="Acces rapide donnees">
      <button type="button" class="quick-btn menu-action" data-action="layers" aria-label="Couches" title="Couches">ğŸ§±</button>
      <button type="button" class="quick-btn menu-action" data-action="legend" aria-label="Legende" title="Legende">ğŸ—ºï¸</button>
      <button type="button" class="quick-btn menu-action" data-action="download" aria-label="Telecharger" title="Telecharger">â¬‡ï¸</button>
    </div>

    <aside id="layersPanel" class="panel panel-left" aria-label="Panneau couches">
      <div class="panel-header">
        <h2>Couches</h2>
        <button type="button" class="icon-btn panel-close" data-close-panel="layersPanel" aria-label="Fermer panneau couches">x</button>
      </div>
      <div class="panel-body">
        <div id="layersList"></div>
      </div>
    </aside>

    <aside id="legendPanel" class="panel panel-right" aria-label="Panneau legende">
      <div class="panel-header">
        <h2>Legende</h2>
        <button type="button" class="icon-btn panel-close" data-close-panel="legendPanel" aria-label="Fermer panneau legende">x</button>
      </div>
      <div class="panel-body">
        <div id="legendContent"></div>
      </div>
    </aside>

    <button id="fabButton" class="fab-button" type="button" aria-label="Actions rapides">+</button>
    <div id="fabMenu" class="fab-menu" aria-label="Menu actions rapides">
      <button type="button" class="fab-item menu-action" data-action="layers">ğŸ§± Couches</button>
      <button type="button" class="fab-item menu-action" data-action="legend">ğŸ—ºï¸ Legende</button>
      <button type="button" class="fab-item menu-action" data-action="analysis">ğŸ›°ï¸ Analyse</button>
      <button type="button" class="fab-item menu-action" data-action="analysis-modal">ğŸ¯ Analyse avancee</button>
      <button type="button" class="fab-item menu-action" data-action="routing">ğŸ›£ï¸ Itineraire</button>
      <button type="button" class="fab-item menu-action" data-action="measure">ğŸ“ Mesure</button>
    </div>

    <div id="analysisModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="analysisTitle">
      <div class="modal-content">
        <div class="panel-header">
          <h2 id="analysisTitle">Analyse avancee</h2>
          <button type="button" class="icon-btn" id="closeAnalysis" aria-label="Fermer analyse">x</button>
        </div>
        <div class="panel-body analysis-form">
          <label>Couche cible
            <select id="analysisLayer">
              <option value="Ecoles">Ecoles</option>
              <option value="Localites">Localites</option>
              <option value="Routes">Routes</option>
            </select>
          </label>
          <label>Rayon (metres)
            <input id="analysisRadius" type="number" min="100" max="50000" step="100" value="5000">
          </label>
          <label>Maximum resultats
            <input id="analysisLimit" type="number" min="1" max="200" step="1" value="25">
          </label>
          <div class="analysis-actions">
            <button id="startAnalysis" type="button" class="icon-btn">Choisir point sur carte</button>
            <button id="clearAnalysis" type="button" class="icon-btn">Nettoyer analyse</button>
          </div>
          <div id="analysisResult" class="analysis-result">Aucun resultat.</div>
        </div>
      </div>
    </div>

    <div id="metadataModal" class="modal" role="dialog" aria-modal="true" aria-labelledby="metadataTitle">
      <div class="modal-content">
        <div class="panel-header">
          <h2 id="metadataTitle">Metadonnees</h2>
          <button type="button" class="icon-btn" id="closeMetadata" aria-label="Fermer metadonnees">x</button>
        </div>
        <div class="panel-body">
          <p><strong>Projet:</strong> GeoWeb Kaffrine</p>
          <p><strong>Systeme:</strong> WGS84 (EPSG:4326)</p>
          <p><strong>Couches:</strong> Region, Departement, Arrondissement, Routes, Localites, Ecoles</p>
        </div>
      </div>
    </div>

    <div id="installToast" class="install-toast" aria-live="polite">
      <span>Installer l'application GeoWeb Kaffrine ?</span>
      <div class="install-actions">
        <button type="button" id="installNow" class="icon-btn">Installer</button>
        <button type="button" id="installLater" class="icon-btn">Plus tard</button>
      </div>
    </div>

    <div id="toastRack" class="toast-rack" aria-live="polite"></div>
    <div id="uiOverlay" class="ui-overlay" aria-hidden="true"></div>
  </div>

  <script src="js/leaflet.js"></script>
  <script src="js/leaflet-measure.js"></script>
  <script src="data/Region_3.js"></script>
  <script src="data/Departement_4.js"></script>
  <script src="data/Arrondissement_5.js"></script>
  <script src="data/Routes_6.js"></script>
  <script src="data/Localites_7.js"></script>
  <script src="data/Ecoles_8.js"></script>

  <script src="js/theme.js"></script>
  <script src="js/map.js"></script>
  <script src="js/ui.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
